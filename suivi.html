<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title data-i18n="order_tracking_title">Suivi de Commande – SecurityNoPhone</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="flags/flags.css" />
  <style>
    body {
      background-image: url('images/background_black_abstract_dark_backdrop_web_website_wallpaper-1005124.jpg!d');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      color: #333;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    main {
      flex: 1;
    }

    .tracking-box {
      background: #ffffffee;
      padding: 2rem;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }
  </style>
</head>

<body>
  <!-- Navbar incluse dynamiquement -->
  <div id="navbar-placeholder"></div>

  <main class="container my-5" style="margin-top: 100px;"><br><br>
    <div class="row g-4 align-items-start">
      <div class="col-md-6">
        <div class="tracking-box">
          <h2 class="mb-4 text-center" data-i18n="order_tracking_title">Suivre ma commande</h2>
          <form id="trackingForm">
            <div class="mb-3">
              <label for="orderId" class="form-label" data-i18n="order_input_label">Numéro de commande reçu par mail
                :</label>
              <input type="text" class="form-control" id="orderId" placeholder="Ex : CMD123"
                data-i18n-placeholder="order_placeholder" required />
            </div>
            <div class="text-center">
              <button type="submit" class="btn btn-dark" data-i18n="order_check_button">Afficher le statut</button>
            </div>
          </form>
          <div id="statusResult" class="mt-4 text-center fw-bold text-success"></div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="tracking-box">
          <h3 class="mb-3">Comment suivre votre commande ?</h3>
          <p>Une fois votre commande passée, vous recevrez un numéro unique. Ce numéro vous permet de connaître l’état
            d’avancement de la préparation, de l’expédition et de la livraison de votre matériel SecurityNoPhone.</p>
          <p>Nous mettons à jour en temps réel les statuts de commande pour que vous soyez toujours informé. Merci pour
            votre confiance !</p>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer incluse dynamiquement -->
  <div id="footer-placeholder"></div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/translations.js"></script>
  <script src="js/main.js"></script>

  <!-- Include navbar + footer + langue -->
  <script>
    async function loadIncludes() {
        const [navRes, footerRes] = await Promise.all([
          fetch('includes/navbar.html'),
          fetch('includes/footer.html')
        ]);

        const navHtml = await navRes.text();
        const footerHtml = await footerRes.text();

        document.getElementById('navbar-placeholder').innerHTML = navHtml;
        document.getElementById('footer-placeholder').innerHTML = footerHtml;

        document.getElementById('footer-placeholder').innerHTML = footerHtml;

      // Gérer le bouton cookie après chargement du footer
      const cookieBtn = document.querySelector("#cookie-banner button");
      if (cookieBtn) {
        cookieBtn.addEventListener("click", () => {
          localStorage.setItem("cookiesAccepted", "true");
          document.getElementById("cookie-banner").style.display = "none";
        });

        if (localStorage.getItem("cookiesAccepted") === "true") {
          document.getElementById("cookie-banner").style.display = "none";
        }
      }

        // Après insertion, appliquer les traductions et activer le suivi
        if (typeof switchLanguage === "function") switchLanguage();
        setupTrackingForm();
      }
    

    function setupTrackingForm() {
      const form = document.getElementById('trackingForm');
      if (!form) return;

      form.addEventListener('submit', function (e) {
        e.preventDefault();
        const orderId = document.getElementById('orderId').value.trim().toUpperCase();
        const lang = localStorage.getItem('lang') || 'fr';
        const t = window.translations?.[lang] || {};

        const statuses = {
          "CMD123": t["order_status_1"],
          "CMD456": t["order_status_2"],
          "CMD789": t["order_status_3"]
        };

        const result = statuses[orderId] || t["order_result_notfound"];
        document.getElementById('statusResult').textContent = result;
      });
    }

    loadIncludes();
  </script>
</body>

</html>